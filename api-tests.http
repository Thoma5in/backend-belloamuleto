// ===========================================================================
// ARCHIVO DE PRUEBA PARA TESTEAR LA API
// ===========================================================================
// Puedes usar este archivo con herramientas como:
// - REST Client (extensión de VS Code)
// - Postman (importar como colección)
// - cURL (copiar los comandos)
// ===========================================================================

### Variables
@baseUrl = http://localhost:3000
@apiUrl = {{baseUrl}}/api

### ========== HEALTH CHECK ==========

### 1. Root endpoint
GET {{baseUrl}}/

### 2. Health check
GET {{apiUrl}}/health

### ========== AUTH ==========

### 2.1 Registro de usuario
POST {{apiUrl}}/auth/register
Content-Type: application/json

{
  "email": "nuevo.usuario@ejemplo.com",
  "password": "Password123",
  "nombre": "Nuevo Usuario",
  "direccion": "Av. Principal 123",
  "telefono": "+51 999 999 999"
}

### ========== PRODUCTOS - LECTURA ==========

### 3. Obtener todos los productos (sin filtros)
GET {{apiUrl}}/products

### 4. Obtener productos con paginación
GET {{apiUrl}}/products?page=1&limit=5

### 5. Obtener productos con filtros
GET {{apiUrl}}/products?category=electronics&minPrice=100&maxPrice=500&sortBy=price&sortOrder=asc

### 6. Obtener producto por ID (reemplaza con un UUID real de tu BD)
GET {{apiUrl}}/products/123e4567-e89b-12d3-a456-426614174000

### 7. Buscar productos por nombre
GET {{apiUrl}}/products/search?q=laptop

### 8. Obtener productos por categoría
GET {{apiUrl}}/products/category/electronics

### 9. Obtener productos con stock bajo
GET {{apiUrl}}/products/low-stock

### ========== PRODUCTOS - ESCRITURA ==========

### 10. Crear nuevo producto
POST {{apiUrl}}/products
Content-Type: application/json

{
  "name": "MacBook Pro 16",
  "description": "Laptop profesional para desarrollo",
  "price": 2499.99,
  "stock": 10,
  "category": "electronics",
  "is_active": true
}

### 11. Actualizar producto completo (reemplaza ID)
PUT {{apiUrl}}/products/123e4567-e89b-12d3-a456-426614174000
Content-Type: application/json

{
  "name": "MacBook Pro 16 M2",
  "description": "Laptop profesional con chip M2",
  "price": 2699.99,
  "stock": 15,
  "category": "electronics",
  "is_active": true
}

### 12. Actualizar solo el stock (agregar 10 unidades)
PATCH {{apiUrl}}/products/123e4567-e89b-12d3-a456-426614174000/stock
Content-Type: application/json

{
  "quantity": 10
}

### 13. Actualizar solo el stock (restar 5 unidades)
PATCH {{apiUrl}}/products/123e4567-e89b-12d3-a456-426614174000/stock
Content-Type: application/json

{
  "quantity": -5
}

### 14. Eliminar producto (soft delete)
DELETE {{apiUrl}}/products/123e4567-e89b-12d3-a456-426614174000

### ========== CASOS DE ERROR ==========

### 15. Crear producto sin campos requeridos (debe fallar)
POST {{apiUrl}}/products
Content-Type: application/json

{
  "description": "Producto sin nombre"
}

### 16. Crear producto con precio negativo (debe fallar)
POST {{apiUrl}}/products
Content-Type: application/json

{
  "name": "Producto Inválido",
  "price": -100,
  "stock": 10
}

### 17. Obtener producto con ID inválido (debe fallar)
GET {{apiUrl}}/products/invalid-id

### 18. Buscar sin término de búsqueda (debe fallar)
GET {{apiUrl}}/products/search

### 19. Actualizar stock con cantidad no numérica (debe fallar)
PATCH {{apiUrl}}/products/123e4567-e89b-12d3-a456-426614174000/stock
Content-Type: application/json

{
  "quantity": "diez"
}

### 20. Ruta no existente (404)
GET {{apiUrl}}/productos/inexistente

### ========== CARRITO ==========

### 21. Obtener carrito del usuario (envía usuario_id en body)
GET {{apiUrl}}/carrito
Content-Type: application/json

{
  "usuario_id": 1
}

### 22. Agregar producto al carrito
POST {{apiUrl}}/carrito/items
Content-Type: application/json

{
  "usuario_id": 1,
  "producto_id": 1,
  "cantidad": 2
}

### 23. Actualizar cantidad de un producto en el carrito
PUT {{apiUrl}}/carrito/items/1
Content-Type: application/json

{
  "usuario_id": 1,
  "cantidad": 3
}

### 24. Eliminar un producto del carrito
DELETE {{apiUrl}}/carrito/items/1
Content-Type: application/json

{
  "usuario_id": 1
}

### 25. Vaciar el carrito por completo
DELETE {{apiUrl}}/carrito
Content-Type: application/json

{
  "usuario_id": 1
}

### ========== ROLES ==========

### 26. Obtener todos los roles
GET {{apiUrl}}/roles

### 27. Obtener rol por ID
GET {{apiUrl}}/roles/550e8400-e29b-41d4-a716-446655440000

### 28. Crear nuevo rol
POST {{apiUrl}}/roles
Content-Type: application/json

{
  "nombre": "Gerente",
  "descripcion": "Rol de gerente con permisos administrativos"
}

### 29. Actualizar rol
PUT {{apiUrl}}/roles/550e8400-e29b-41d4-a716-446655440000
Content-Type: application/json

{
  "nombre": "Gerente Senior",
  "descripcion": "Gerente con permisos avanzados"
}

### 30. Eliminar rol
DELETE {{apiUrl}}/roles/550e8400-e29b-41d4-a716-446655440000

### ========== EMPLEADOS ==========

### 31. Obtener todos los empleados
GET {{apiUrl}}/empleados

### 32. Obtener solo empleados activos
GET {{apiUrl}}/empleados?activos=true

### 33. Obtener empleados con roles anidados
GET {{apiUrl}}/empleados/with-roles

### 34. Obtener empleado por ID (usuario_id)
GET {{apiUrl}}/empleados/550e8400-e29b-41d4-a716-446655440001

### 35. Obtener empleado con sus roles
GET {{apiUrl}}/empleados/550e8400-e29b-41d4-a716-446655440001/with-roles

### 36. Crear nuevo empleado
POST {{apiUrl}}/empleados
Content-Type: application/json

{
  "usuario_id": "550e8400-e29b-41d4-a716-446655440002",
  "numero_empleado": "EMP-2026-001",
  "fecha_contratacion": "2026-02-25",
  "departamento": "Desarrollo",
  "activo": true
}

### 37. Actualizar empleado
PUT {{apiUrl}}/empleados/550e8400-e29b-41d4-a716-446655440002
Content-Type: application/json

{
  "numero_empleado": "EMP-2026-001",
  "departamento": "Desarrollo Backend",
  "activo": true
}

### 38. Eliminar empleado
DELETE {{apiUrl}}/empleados/550e8400-e29b-41d4-a716-446655440002

### ========== EMPLEADOS-ROLES ==========

### 39. Obtener todas las asignaciones rol-empleado
GET {{apiUrl}}/empleados-roles

### 40. Obtener roles de un empleado
GET {{apiUrl}}/empleados/550e8400-e29b-41d4-a716-446655440001/roles

### 41. Asignar un rol a un empleado
POST {{apiUrl}}/empleados/550e8400-e29b-41d4-a716-446655440001/roles
Content-Type: application/json

{
  "rol_id": "550e8400-e29b-41d4-a716-446655440000",
  "otorgado_por": "550e8400-e29b-41d4-a716-446655440003"
}

### 42. Asignar múltiples roles a un empleado
POST {{apiUrl}}/empleados/550e8400-e29b-41d4-a716-446655440001/roles
Content-Type: application/json

{
  "roles_ids": [
    "550e8400-e29b-41d4-a716-446655440000",
    "550e8400-e29b-41d4-a716-446655440010"
  ],
  "otorgado_por": "550e8400-e29b-41d4-a716-446655440003"
}

### 43. Asignar múltiples roles (endpoint explícito)
POST {{apiUrl}}/empleados/550e8400-e29b-41d4-a716-446655440001/roles/bulk
Content-Type: application/json

{
  "roles_ids": [
    "550e8400-e29b-41d4-a716-446655440000",
    "550e8400-e29b-41d4-a716-446655440010",
    "550e8400-e29b-41d4-a716-446655440020"
  ],
  "otorgado_por": "550e8400-e29b-41d4-a716-446655440003"
}

### 44. Verificar si un empleado tiene un rol
GET {{apiUrl}}/empleados/550e8400-e29b-41d4-a716-446655440001/roles/550e8400-e29b-41d4-a716-446655440000/verificar

### 45. Revocar rol específico de un empleado
DELETE {{apiUrl}}/empleados/550e8400-e29b-41d4-a716-446655440001/roles/550e8400-e29b-41d4-a716-446655440000

### 46. Revocar todos los roles de un empleado
DELETE {{apiUrl}}/empleados/550e8400-e29b-41d4-a716-446655440001/roles

### 47. Obtener todos los empleados con un rol específico
GET {{apiUrl}}/roles/550e8400-e29b-41d4-a716-446655440000/empleados

### ========== NOTAS ==========
# 
# 1. Reemplaza los UUIDs de ejemplo con IDs reales de tu base de datos
# 2. Verifica que el servidor esté corriendo en el puerto correcto
# 3. Las respuestas con error mostrarán detalles en desarrollo
# 4. En producción, los errores mostrarán mensajes genéricos
# 
# Estructura de respuestas exitosas:
# {
#   "success": true,
#   "data": { ... },
#   "pagination": { ... } // solo en listados
# }
#
# Estructura de respuestas con error:
# {
#   "success": false,
#   "error": {
#     "message": "...",
#     "statusCode": 400
#   }
# }
#
# ENDPOINTS AGREGADOS:
# - Roles: 5 endpoints (GET all, GET by ID, POST create, PUT update, DELETE)
# - Empleados: 7 endpoints (GET all con filtro, GET by ID, POST create, PUT update, DELETE, GET with roles, GET all with roles)
# - EmpleadosRoles: 8 endpoints (GET all asignaciones, GET roles de empleado, POST asignar, DELETE revocar, etc)
#
# Total: 20 endpoints para gestionar roles, empleados y sus relaciones
